# A study on reproducibility smells
This study, first, identifies such programming practices
that we refer to as **reproducibility smells** by conducting a comprehensive multi-vocal review and propose a first-ever validated catalog of reproducibility smells for IaC scripts. We implement a
tool viz. **REDUSE** to identify reproducibility smells in Ansible scripts. Furthermore, we carry out an empirical
study to reveal the proliferation of reproducibility smells in open-source projects and explore correlation and
co-occurrence relationships among them.


We elaborate on the contents of the individual folder of this repository below.

## Multi-vocal literature review(`mlr`)

This folder contains the following files.

- `grey-literature-source.xlsx`: This Excel file contains all the information about the grey literature resources. It has following sheets.
  - `Links`: contains information about the type of the documents, content of the document, what IaC language or concept it is related to and the corresponding link to the document.
  - `Reviewer-1-QA`: contains the marking assessment of each document from the reviewer-1 for the grey literature.
  - `Reviewer-2-QA`: contains the marking assessment of each document from the reviewer-2 for the grey literature.
  - `Grey Literature Sources`: contains the source numbers, best practice/ bad practice that each of the literature are mentioning and a summary.
  - `Search Queries`: shows that how many documents we gain for each search query, how many filtered with the exclusion/inclusion criteria and number of final documents. 
  - `smell-reference`: shows a list of references that each of the smells are extracted from the them. 
  - `Quality Assessment final`: contains the final and merged marking assessment of each document from the both reviewers for the grey literature.

## REDUCE - a reproducibility smells detection tool (`reduse`)
The tool is designed to detect reproducibility smells in Ansible scripts.
You can provide your ansible script in `.yml` format and get output of the tool as a `csv` file containing task name, task number, smell name, reason of having the smell on  the task.

### Build/Configure
- This tool requires Python 3.8+
- Install the packages from `reduse\src\requirements.txt`

### Run the tool
Run the `detector.py` file in the `reduse\src` folder with the path to your desired Ansible yaml file.
```shell
python detector.py '/path/to/file/folder
```
Or, add the path to the desired ansible files or repositories to the script and then execute
```shell
/bin/bash run_detector.sh
```

### Manual validation (`reduse\manual-validation`)
This folder contains all the scripts i.e., the subject systems and detection smells by the tool as well as by the evaluators.

- `scripts`: Selected scripts for evaluation
- `results`: Detected smells by human evaluators and the tool. Each subfolder contains two kinds of files. Files ending with `manual` are produced by human evaluators whereas files ending with `tool` are generated by the tool.
   

### Reproducibility smell examples
This file contains the code for the example scenarios mentioned in the category in the paper.

### Ansible galaxy issues.pdf
### Qualitative analysis sheets
These files contains the issues extracted from the top 8 ansible galaxy repositories that mapped to the reproducibility smells.
### REDUSE - Tool for detecting Reproducibility Smells
**`src`**:
- **`extraction`**:
  - **`extracted_repos`**: 
      This folder contains text files. 
      Each text file contains the links extracted from 9 categories of the 
      ansible galaxy top 100 of the most-downloaded repositories after applying criteria check on the github repository.
  - **`script`**:
      - **`criteria_check.py`**:
        This script applies criterias on the github links. 
        5 stars, 50 commits, last commit not older than 1 year ago.
      - **`link_extractor.py`**:
        This script extracts github links from the given url. 
        used for extracting the projects from the ansible galaxy.
      - **`script_extractor.py`**:
        This script gets a github link and extracts the .yml files of the repository.

- **`output`**:
  This folder contains all the detection results on the scripts.

- **`detector.py`**: 
    - This scripts contains the main logic of the tool.
    - It gets the path to the ansible script file and parse it.
    - using parsed tasks it detects the smells for each task.
- **`parser.py`**: 
    - This scripts parses a given ansible script and returns a dictionary containing the tasks of the script.
- **`smell_detection.py`**: 
    - This scripts consists of the smell detection functions. 
      each function is trying to detect one smell according to the rules specified and provides a message.
- **`results.py`**:
    - This script creates 2 csv files in 2 formats as output. 
    
**`test`**:
- **`testScripts`**:
  This folder contains the original ansible scripts from the ansible galaxy and ansible-oci-collection.
- **`unit_test`**:
  This folder contains the unit-tests for the smell_detection functions.
